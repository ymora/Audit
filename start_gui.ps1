# Script PowerShell pour lancer l'Interface Graphique - Syst√®me d'Audit Universel
# =============================================================================

Write-Host "üîç Lancement de l'Interface Graphique - Syst√®me d'Audit Universel" -ForegroundColor Cyan
Write-Host "=" * 60 -ForegroundColor Cyan
Write-Host ""

# V√©rifier que Python est disponible
try {
    $pythonVersion = python --version 2>&1
    Write-Host "‚úÖ Python d√©tect√©: $pythonVersion" -ForegroundColor Green
} catch {
    Write-Host "‚ùå Python non trouv√©. Veuillez installer Python." -ForegroundColor Red
    exit 1
}

# Chemin vers le script de lancement
$auditDir = Split-Path -Parent $MyInvocation.MyCommand.Path
$launchScript = Join-Path $auditDir "launch_gui.py"

if (-not (Test-Path $launchScript)) {
    Write-Host "‚ùå Script de lancement introuvable: $launchScript" -ForegroundColor Red
    exit 1
}

Write-Host "‚úÖ Script de lancement trouv√©: $launchScript" -ForegroundColor Green
Write-Host "üöÄ Lancement de l'interface graphique..." -ForegroundColor Yellow
Write-Host ""

try {
    # Lancer l'interface graphique
    python $launchScript
    
    if ($LASTEXITCODE -eq 0) {
        Write-Host ""
        Write-Host "‚úÖ Interface graphique ferm√©e avec succ√®s." -ForegroundColor Green
    } else {
        Write-Host ""
        Write-Host "‚ùå Erreur lors de l'ex√©cution de l'interface graphique." -ForegroundColor Red
    }
} catch {
    Write-Host ""
    Write-Host "‚ùå Erreur lors du lancement: $_" -ForegroundColor Red
    exit 1
}

Write-Host ""
Write-Host "Appuyez sur une touche pour fermer..." -ForegroundColor Gray
$null = $Host.UI.RawUI.ReadKey("NoEcho,IncludeKeyDown")
